---
const menuItems = [
  { 
    title: "Experience", 
    path: "#experience", 
    icon: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
      <line x1="8" y1="21" x2="16" y2="21"/>
      <line x1="12" y1="17" x2="12" y2="21"/>
    </svg>`
  },
  { 
    title: "Skills", 
    path: "#skills", 
    icon: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <polygon points="13,2 3,14 12,14 11,22 21,10 12,10"/>
    </svg>`
  },
  { 
    title: "About me", 
    path: "#about", 
    icon: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
      <circle cx="12" cy="7" r="4"/>
    </svg>`
  },
  { 
    title: "Contact", 
    path: "#contact", 
    icon: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
      <polyline points="22,6 12,13 2,6"/>
    </svg>`
  },
];
---

<!-- Desktop Sidebar Navigation -->
<nav class="hidden lg:flex fixed left-0 top-0 h-full w-64 bg-white/95 dark:bg-gray-900/95 backdrop-blur-sm border-r border-gray-200 dark:border-gray-700 z-50 transition-all duration-300">
  <div class="flex flex-col h-full w-full">
    <div class="flex items-center justify-start h-16 px-4 border-b border-gray-200">
      <a href="#home" class="text-2xl font-bold text-blue-600">
        SalazarWeb
      </a>
    </div>

    <!-- Navigation Menu -->
    <div class="flex-1 flex flex-col justify-center">
      <ul class="space-y-2 px-3">
        {
          menuItems.map((item) => (
            <li>
              <a
                href={item.path}
                class="group flex items-center justify-start w-full px-3 py-3 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-300"
              >
                <span class="flex items-center justify-center" set:html={item.icon}></span>
                <span class="ml-3 font-medium">{item.title}</span>
              </a>
            </li>
          ))
        }
      </ul>
    </div>

    <!-- Download CV Button -->
    <div class="p-4 border-t border-gray-200 dark:border-gray-700">
      <a
        href="src/assets/David_Salazar_CV.pdf"
        download
        class="whatsapp-button hover-metallic flex items-center gap-2 px-4 py-2 rounded-full bg-blue-500 text-white transition-all duration-300 hover:scale-105 hover:shadow-lg"
      >
        <svg class="w-5 h-5 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
        </svg>
        <span>Download CV</span>
      </a>
    </div>
  </div>
</nav>

<!-- Mobile Bottom Navigation -->
<nav class="lg:hidden fixed bottom-0 left-0 right-0 bg-white/95 dark:bg-gray-900/95 backdrop-blur-sm border-t border-gray-200 dark:border-gray-700 z-50">
  <div class="flex items-center justify-around px-2 py-2">
    {
      menuItems.map((item) => (
        <a
          href={item.path}
          class="mobile-nav-link flex flex-col items-center justify-center p-3 text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-all duration-300 rounded-lg min-w-0 flex-1"
        >
          <span class="flex items-center justify-center mb-1" set:html={item.icon}></span>
          <span class="text-xs font-medium truncate">{item.title}</span>
        </a>
      ))
    }
    <!-- Download CV Button for Mobile -->
    <a
    href="src/assets/David_Salazar_CV.pdf"
    download
    class="mobile-nav-link flex flex-col items-center justify-center p-3 text-blue-600 hover:bg-blue-500 hover:text-gray-200 transition-all duration-300 rounded-lg min-w-0 flex-1"
  >
    <svg class="w-5 h-5 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
    </svg>
    <span class="text-xs">CV</span>
  </a>
  </div>
</nav>

<script>
  function setupSidebarNavigation() {
    const sections = document.querySelectorAll('section[id]');
    const navLinks = document.querySelectorAll('nav a[href^="#"]');

    function highlightActiveSection() {
      let current = '';
      
      sections.forEach(section => {
        const sectionTop = (section as HTMLElement).offsetTop;
        if (window.scrollY >= sectionTop - 100) {
          current = section.getAttribute('id') || '';
        }
      });

      // Update active navigation link
      navLinks.forEach(link => {
        link.classList.remove('text-blue-600', 'dark:text-blue-400', 'bg-blue-50', 'dark:bg-blue-900/20');
        link.classList.add('text-gray-600', 'dark:text-gray-300');
        
        if (link.getAttribute('href') === `#${current}`) {
          link.classList.remove('text-gray-600', 'dark:text-gray-300');
          link.classList.add('text-blue-600', 'dark:text-blue-400', 'bg-blue-50', 'dark:bg-blue-900/20');
        }
      });
    }

    // Smooth scroll
    navLinks.forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const targetId = link.getAttribute('href')?.substring(1);
        const targetSection = document.getElementById(targetId || '');
        
        if (targetSection) {
          targetSection.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
          });
        }
      });
    });

    window.addEventListener('scroll', highlightActiveSection);
    highlightActiveSection();
  }

  setupSidebarNavigation();
  document.addEventListener('astro:page-load', setupSidebarNavigation);
</script>

<style>
  /* Download CV Button Animations */
  .download-cv-button {
    box-shadow: 0 4px 6px rgba(59, 130, 246, 0.25);
    font-weight: 600;
    position: relative;
    overflow: hidden;
  }

  .download-cv-button::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(255, 255, 255, 0.1);
    transform: translateX(-100%) skewX(-15deg);
    transition: transform 0.4s ease;
  }

  .download-cv-button:hover::before {
    transform: translateX(100%) skewX(-15deg);
  }

  .download-cv-button:hover svg {
    transform: scale(1.2);
  }

  .download-cv-button:active {
    transform: translateY(2px) scale(0.98);
    box-shadow: 0 2px 3px rgba(59, 130, 246, 0.2);
  }
</style>